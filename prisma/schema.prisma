// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

enum AdvisorRole {
  DEVELOPER
  MANAGEMENT
  AGENT
}

enum ContactChannelType {
  HOME
  CELL
  OFFICE
}

enum EmailChannelType {
  PERSONAL
  OFFICE
}

enum AddressType {
  PERSONAL
  OFFICE
}

enum RelationshipType {
  SPOUSE
  CHILD
  PARENT
  SIBLING
  FRIEND
  RELATIVE
  PARTNER
  DOMESTIC_PARTNER
  COWORKER
  OTHER
}

enum LoyaltyCategory {
  HOTEL
  AIRLINE
  CRUISE
  CAR_RENTAL
  RAIL_BUS
}

enum TravelDocumentType {
  PASSPORT
  VISA
  TSA_GLOBAL_ENTRY
}

model Advisor {
  id           String   @id @default(cuid())
  name         String
  email        String   @unique
  passwordHash String
  role         AdvisorRole @default(AGENT)
  createdAt    DateTime @default(now())
}

model HeroSection {
  id         String   @id @default(cuid())
  titleEs    String
  titleEn    String
  subtitleEs String
  subtitleEn String
  mediaUrl   String?
  mediaType  String?
  updatedAt  DateTime @updatedAt
}

model Special {
  id            String   @id @default(cuid())
  titleEs       String
  titleEn       String
  descriptionEs String
  descriptionEn String
  price         String
  active        Boolean  @default(true)
  createdAt     DateTime @default(now())
}

model Tour {
  id           String   @id @default(cuid())
  name         String
  shortDescription String?
  summary      String
  includes     String?
  excludes     String?
  highlights   String?
  isActive     Boolean  @default(true)
  sortOrder    Int      @default(0)
  deletedAt    DateTime?
  continent    String
  country      String
  city         String
  durationDays Int
  price        String
  cardImageUrl String?
  bannerImageUrl String?
  photoUrl     String?
  videoUrl     String?
  createdAt    DateTime @default(now())
  galleryImages TourGalleryImage[]
}

model TourGalleryImage {
  id        String   @id @default(cuid())
  tourId    String
  url       String
  sortOrder Int      @default(0)
  createdAt DateTime @default(now())
  tour      Tour     @relation(fields: [tourId], references: [id], onDelete: Cascade)
}

model Review {
  id         String   @id @default(cuid())
  clientName String
  quoteEs    String
  quoteEn    String
  rating     Int
  createdAt  DateTime @default(now())
}

model Client {
  id                 String             @id @default(cuid())
  firstName          String
  middleName         String?
  lastName           String
  lastNameMaternal   String?
  email              String
  phone              String?
  website            String?
  jobTitle           String?
  company            String?
  facebookProfile    String?
  instagramProfile   String?
  tiktokProfile      String?
  linkedInProfile    String?
  destination        String?
  travelDate         DateTime?
  dateOfBirth        DateTime?
  anniversary        DateTime?
  travelersInfo      String?
  serviceTypes       String?
  seatPreference     String?
  bedPreference      String?
  mealPreference     String?
  hotelPreferences   String?
  vibePreferences    String?
  activityPreferences String?
  preferences        String?
  additionalComments String?
  preferredContact   String?
  desiredServices    String?
  travelStart        DateTime?
  travelEnd          DateTime?
  message            String?
  source             String             @default("website")
  createdAt          DateTime           @default(now())
  updatedAt          DateTime           @updatedAt
  contactPhones      ClientContactPhone[]
  contactEmails      ClientContactEmail[]
  contactAddresses   ClientContactAddress[]
  relationships      ClientRelationship[] @relation("ClientRelationships")
  relatedToClients   ClientRelationship[] @relation("ClientRelatedTo")
  loyaltyPrograms    ClientLoyaltyProgram[]
  travelDocuments    ClientTravelDocument[]
  communicationLogs  CommunicationLog[]
  tasks              Task[]
}

model ClientContactPhone {
  id        String             @id @default(cuid())
  clientId  String
  type      ContactChannelType @default(CELL)
  value     String
  createdAt DateTime           @default(now())
  client    Client             @relation(fields: [clientId], references: [id], onDelete: Cascade)
}

model ClientContactEmail {
  id        String           @id @default(cuid())
  clientId  String
  type      EmailChannelType @default(PERSONAL)
  value     String
  createdAt DateTime         @default(now())
  client    Client           @relation(fields: [clientId], references: [id], onDelete: Cascade)
}

model ClientContactAddress {
  id            String      @id @default(cuid())
  clientId      String
  type          AddressType @default(PERSONAL)
  addressLine1  String
  addressLine2  String?
  city          String?
  stateProvince String?
  postalCode    String?
  country       String?
  createdAt     DateTime    @default(now())
  client        Client      @relation(fields: [clientId], references: [id], onDelete: Cascade)
}

model ClientRelationship {
  id              String           @id @default(cuid())
  clientId        String
  relatedClientId String
  relationType    RelationshipType
  createdAt       DateTime         @default(now())
  client          Client           @relation("ClientRelationships", fields: [clientId], references: [id], onDelete: Cascade)
  relatedClient   Client           @relation("ClientRelatedTo", fields: [relatedClientId], references: [id], onDelete: Cascade)

  @@unique([clientId, relatedClientId, relationType])
}

model ClientLoyaltyProgram {
  id               String          @id @default(cuid())
  clientId         String
  category         LoyaltyCategory
  programName      String
  membershipNumber String?
  createdAt        DateTime        @default(now())
  client           Client          @relation(fields: [clientId], references: [id], onDelete: Cascade)
}

model ClientTravelDocument {
  id                      String             @id @default(cuid())
  clientId                String
  type                    TravelDocumentType
  fullName                String?
  encryptedDocumentNumber String
  numberLast4             String?
  countryOfIssue          String?
  dateOfIssue             DateTime?
  dateOfExpiration        DateTime?
  sex                     String?
  placeOfBirth            String?
  nationality             String?
  citizenship             String?
  photoUrl                String?
  createdAt               DateTime           @default(now())
  updatedAt               DateTime           @updatedAt
  client                  Client             @relation(fields: [clientId], references: [id], onDelete: Cascade)
}

model CommunicationLog {
  id        String   @id @default(cuid())
  clientId  String
  note      String
  channel   String   @default("manual")
  createdAt DateTime @default(now())
  client    Client   @relation(fields: [clientId], references: [id], onDelete: Cascade)
}

model Task {
  id        String   @id @default(cuid())
  clientId  String
  title     String
  status    String   @default("pendiente")
  dueDate   DateTime?
  createdAt DateTime @default(now())
  client    Client   @relation(fields: [clientId], references: [id], onDelete: Cascade)
}
